\chapter{Performance Evaluation}\label{cha:performance-evaluation}

As \cite{guo2020ris}, we consider a RIS-aided femtocell network shown in Fig.\ref{fig:simulation_ris_setup}. The BS is equipped with a ULA array with $M=16$ antennas, and the RIS is equipped with
$N=20$ linearly-deployed reflecting elements. The system serves $K=4$ downlink users with a power budget of
$P=20$dBm and noise power of -117dBm. The direction of the radar target is $0^\circ$ from BS. 

\begin{figure}[htb]
  \centering
  \includegraphics[width=0.8\textwidth]{simulation_ris_setup.png}
  \caption{The simulated RIS-aided femtocell network}
  \label{fig:simulation_ris_setup}
\end{figure}

In separated deployment, the resources are equally divided and allocated to radar and communication functions, 
i.e., $M_c=M_r=M/2$ and $P_c=P_r=P/2$. We assume that the BS-RIS and RIS-user channel 
follows the Rician fading and the BS-user channel experiences the Rayleigh fading. Thus, the channels
${\bf H}_c$, ${\bf H}_r$ and ${\bf h}_k$ are modeled as 
\begin{align}
    &{\bf H}_c = \sqrt{L_{BR}} \left( \sqrt{\frac{\varepsilon}{\varepsilon+1}} {\bf a}_{\mathrm{RIS}}(\vartheta) {\bf a}_c^H(\varphi) + \sqrt{\frac{1}{\varepsilon+1}} \check{\bf H}_c \right) \\
    &{\bf H}_r = \sqrt{L_{BR}} \left( \sqrt{\frac{\varepsilon}{\varepsilon+1}} {\bf a}_{\mathrm{RIS}}(\vartheta) {\bf a}_r^H(\varphi) + \sqrt{\frac{1}{\varepsilon+1}} \check{\bf H}_r \right) \\
    &{\bf h}_k = \sqrt{L_{RU}} \left( \sqrt{\frac{\varepsilon}{\varepsilon+1}} {\bf a}_{\mathrm{RIS}}(\varsigma_k) + \sqrt{\frac{1}{\varepsilon+1}} \check{\bf h}_k \right)
\end{align}
where $L_{BR}$ and $L_{RU}$ are the path loss, $\varepsilon$ is the Rician factor and $(\check{\bf H}_c, \check{\bf H}_r, \check{\bf h}_k)$
are NLOS components that follow Rayleigh fading. The BS-user channels ${\bf d}_{r,k}$ and ${\bf d}_{c,k}$ are assumed to 
follow Rayleigh fading. In the baseline, only the direct channels ${\bf d}_{r,k}$ and ${\bf d}_{c,k}$ are considered. 

In shared deployment, the channel ${\bf H}$ is similarly formulated as
\begin{equation}
    {\bf H} = \sqrt{L_{BR}} \left( \sqrt{\frac{\varepsilon}{\varepsilon+1}} {\bf a}_{\mathrm{RIS}}(\vartheta) {\bf a}^H(\varphi) + \sqrt{\frac{1}{\varepsilon+1}} \check{\bf H} \right)
\end{equation}

Table \ref{tab:reference_parameters} shows the detailed simulation parameters which is similar to \cite{guo2020ris}. 
In particular, the path loss model is defined based on 3GPP propagation environment \cite{3gpp.36.814}.

\begin{table}[h!]
  \caption{Simulation parameters}
  \centering
  \begin{tabular}{lll}
                                & Parameter                          & Value                                \\ \hline
  \multirow{9}{*}{Transceiver}  & BS Location                        & $(0\mathrm{m},0\mathrm{m})$          \\
                                & RIS Location                       & $(200\mathrm{m},0\mathrm{m})$        \\
                                & User Location                      & within $10\mathrm{m}$ from $(30\mathrm{m},200\mathrm{m})$ \\
                                & Target Direction                   & $0^\circ$ from BS                    \\
                                & Number of Users                    & $K = 4$                              \\
                                & Antennas at BS                     & $M = 16$                             \\
                                & Reflecting Elements                & $N = 20$                             \\
                                & Transmit power                     & $P = 20$dBm                         \\
                                & Noise power                        & $\sigma _n^2 =  - 117$dBm           \\ \hline
  \multirow{2}{*}{Channel}      
                                & Indirect Path Loss                 & $35.6+22.0 \log_{10}(d)$ dB          \\
                                & Direct Path Loss                   & $32.6+36.7 \log_{10}(d)$ dB
  \end{tabular}
  \label{tab:reference_parameters}
\end{table}

\section{Convergence}\label{sec:convergence}
  \input{performance-evaluation/convergence.tex}

\section{Transmission Beampattern Comparison}\label{sec:beampattern_compare}
  \input{performance-evaluation/beampattern.tex}
\newpage

\section{Tradeoff Comparison}\label{sec:tradeoff_compare}
  \input{performance-evaluation/tradeoff.tex}


% \section{MIMO}\label{sec:mimo}
%   \input{performance-evaluation/mimo.tex} 